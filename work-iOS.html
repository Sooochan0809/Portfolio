<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Works｜Kido Sotaro</title>
  <meta name="description" content="作品・協力・アーカイブ" />
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/common.css">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Inter", "Noto Sans JP", "system-ui", "sans-serif"] },
          colors: { brand: { DEFAULT: "#27569b" } }
        }
      }, darkMode: 'class'
    };
    // ライトモードを常に有効にする
    document.documentElement.classList.add('light');
    // もしlocalStorageのthemeがlightなら無視する
    localStorage.setItem('theme', 'light');
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans+JP:wght@300;500;700&display=swap"
    rel="stylesheet">
  <style>
    /* pタグのフォントカラーを指定 */
    p {
      color: #111827;
    }

    @media (prefers-color-scheme: dark) {
      p {
        color: #111827;
      }
    }

    .ratio {
      position: relative;
      width: 100%;
      padding-top: 62.5%
    }

    .ratio>img {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 1rem
    }

    /* 角丸を角に変更 */
    #grid1 article,
    #grid2 article {
      border-radius: 0.2rem !important;
    }

    .ratio>img {
      border-radius: 0.2rem !important;
    }
  </style>
</head>

<body class="bg-white text-zinc-800 antialiased dark:bg-zinc-950 dark:text-zinc-100">
  <!-- header 共通 -->
  <header
    class="fixed inset-x-0 top-0 z-50 backdrop-blur supports-[backdrop-filter]:bg-white/70 dark:supports-[backdrop-filter]:bg-zinc-900/70 border-b border-zinc-200/70 dark:border-zinc-800/70">
    <div class="mx-auto w-full px-4 sm:px-6 lg:px-8 flex items-center justify-between h-[72px]">
      <!-- 左側：ロゴ -->
      <a href="index-iOS.html" class="font-extrabold tracking-tight text-lg">Kido Sotaro</a>

      <!-- 右側：ナビ or ハンバーガー -->
      <div class="flex items-center gap-2">
        <!-- PC表示用ナビ -->
        <nav class="hidden sm:flex gap-6 text-sm">
          <a data-nav href="about-iOS.html" class="hover:text-brand">About</a>
          <a data-nav href="work-iOS.html" class="hover:text-brand">Works</a>
          <a data-nav href="contact-iOS.html" class="hover:text-brand">Contact</a>
        </nav>

        <!-- モバイル表示用ボタン -->
        <button id="menuBtn" class="sm:hidden rounded-xl border border-zinc-300/70 dark:border-zinc-700 p-2"
          aria-label="メニュー">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor"
            stroke-width="1.5">
            <path d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </button>
      </div>
    </div>

    <div id="mobileNav" class="sm:hidden hidden border-t border-zinc-200 dark:border-zinc-800">
      <nav class="mx-auto max-w-6xl px-4 py-3 flex flex-col gap-3 text-sm">
        <a data-nav class="hover:text-brand" href="about-iOS.html">About</a>
        <a data-nav class="hover:text-brand" href="work-iOS.html">Works</a>
        <a data-nav class="hover:text-brand" href="contact-iOS.html">Contact</a>
      </nav>
    </div>
  </header>

  <main class="pt-16">
    <div class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-12" style="background-color: #27569b">
      <!-- Section 1: Works -->
      <section class="py-[10px]" style="background-color: #FEFAEF;">
        <div class="flex items-end justify-between gap-6">
          <div>
            <h1 class="leading-none tracking-tight"
              style="font-weight:320; font-size:clamp(56px,8vw,80px); letter-spacing:-.02em;">WORKS</h1>
            <span class="mb-2 text-sm text-gray-500">研究/作品</span>
          </div>
          <div class="flex items-center gap-2">
          </div>
        </div>
        <div id="grid1" class="mt-[8px] grid sm:grid-cols-2 lg:grid-cols-3 gap-[8px]"></div>
      </section>

      <!-- Section 2: More/Archive -->
      <section class="py-0 pt-[16px]" style="background-color: #FEFAEF;;">
        <div class="flex items-end justify-between gap-6">
          <div>
            <h1 class="leading-none tracking-tight"
              style="font-weight:320; font-size:clamp(56px,8vw,80px); letter-spacing:-.02em;">COOPERATION</h1>
            <span class="mb-2 text-sm text-gray-500">制作協力</span>
          </div>
          <div class="flex items-center gap-2">
          </div>
        </div>
        <div id="grid2" class="mt-[8px] grid sm:grid-cols-2 lg:grid-cols-3 gap-[8px]"></div>
        <footer class="pt-10 pb-0 pr-0 text-right text-sm text-zinc-500">
          LastUpdated <span id="last-updated"></span>
        </footer>
      </section>
    </div>
  </main>

  <script>
    // フッターに最終更新日を表示
    document.getElementById('last-updated').textContent = (function () {
      const d = new Date(document.lastModified);
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, '0');
      const day = String(d.getDate()).padStart(2, '0');
      return `${y}.${m}.${day}`;
    })();
  </script>

  <script src="js/site.js"></script>
  <script src="js/work-data.js"></script>

  <script>
    // ========= Section 1: Works =========
    const grid1 = document.getElementById('grid1');
    const tagFilter1 = document.getElementById('tagFilter1'); // 無ければ null

    function cardHTML1(w) {
      return `
            <article class="group rounded-2xl border overflow-hidden bg-white/60 dark:bg-zinc-950/50 hover:shadow-lg transition" style="transform: scale(0.9); transform-origin: center;">
              <a href="detail-iOS.html?slug=${w.slug}" class="block">
                <div class="ratio"><img src="${w.cover}" alt="${w.title}" loading="lazy"/></div>
                <div class="p-4">
                  <div class="flex items-center justify-between text-xs text-zinc-500"><span>${w.year}</span><span>${w.tags.join(', ')}</span></div>
                  <h3 class="mt-2 text-lg font-semibold group-hover:text-brand">${w.title}</h3>
                  <p class="mt-1 text-xs text-zinc-600 dark:text-zinc-300">${w.summary}</p>
                </div>
              </a>
            </article>`;
    }

    function render1() {
      const tag = tagFilter1?.value || ""; // セレクトが無い場合は空
      const filtered = works.filter(w => !tag || w.tags.includes(tag));

      // 作品カードのHTMLを生成
      const cardsHTML = filtered.map(cardHTML1).join('');

      // 案内のHTMLを生成
      const indicatorHTML = `
        <div class="flex flex-col items-center justify-center p-8 border-2 border-dashed border-gray-200 rounded-md bg-gray-50 transition-colors pointer-events-none select-none">
          <div class="text-sm text-gray-500 mb-3 text-center">スクロールして<br>ご覧ください</div>
          <div class="animate-bounce">
            <svg class="w-6 h-6 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path>
            </svg>
          </div>
        </div>
      `;

      // 作品カードと案内を結合してグリッドに設定
      grid1.innerHTML = cardsHTML;
    }

    // セレクトが存在する場合のみ、候補を埋めてイベント登録
    if (tagFilter1) {
      const allTags1 = Array.from(new Set(works.flatMap(w => w.tags))).sort();
      for (const t of allTags1) {
        const o = document.createElement('option');
        o.value = t;
        o.textContent = t;
        tagFilter1.appendChild(o);
      }
      tagFilter1.addEventListener('change', render1);
    }
    render1();

    // ========= Section 2: Cooperation / Archive =========
    const grid2 = document.getElementById('grid2');
    const tagFilter2 = document.getElementById('tagFilter2'); // 無ければ null

    function cardHTML2(w) {
      return `
           <article class="group rounded-2xl border overflow-hidden bg-white/60 dark:bg-zinc-950/50 hover:shadow-lg transition" style="transform: scale(0.9); transform-origin: center;">
              <a href="detail-iOS.html?slug=${w.slug}" class="block">
                <div class="ratio"><img src="${w.cover}" alt="${w.title}" loading="lazy"/></div>
                <div class="p-4">
                  <div class="flex items-center justify-between text-xs text-zinc-500"><span>${w.year}</span><span>${w.tags.join(', ')}</span></div>
                  <h3 class="mt-2 text-lg font-semibold group-hover:text-brand">${w.title}</h3>
                  <p class="mt-1 text-sm text-zinc-600 dark:text-zinc-300">${w.summary}</p>
                </div>
              </a>
            </article>`;
    }

    function render2() {
      const tag = tagFilter2?.value || "";
      const filtered = worksMore.filter(w => !tag || w.tags.includes(tag));
      grid2.innerHTML = filtered.map(cardHTML2).join('');
    }

    if (tagFilter2) {
      const allTags2 = Array.from(new Set(worksMore.flatMap(w => w.tags))).sort();
      for (const t of allTags2) {
        const o = document.createElement('option');
        o.value = t;
        o.textContent = t;
        tagFilter2.appendChild(o);
      }
      tagFilter2.addEventListener('change', render2);
    }
    render2();
  </script>

</body>

</html>