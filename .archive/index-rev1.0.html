<!doctype html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- OGP設定 -->
    <meta property="og:title" content="城戸 双汰朗/KidoSotaro">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sooochan0809.github.io/test/">
    <meta property="og:image" content="img/ogp.webp">
    <meta property="og:site_name" content="城戸双汰朗">
    <meta property="og:description" content="城戸 双汰朗(きど そうたろう)のポートフォリオサイトです。">
    <meta property="og:locale" content="ja">
    <!-- ここまで -->
    <link rel="icon" type="image/svg+xml" href="img/logo-favicon.svg">
    <title>城戸双汰朗</title>
    <link rel="stylesheet" href="common.css" />

    <style>
        /* 共通のスタイル */
        .feed {
            height: 100vh;
            overflow-y: auto;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        .section {
            height: 100vh;
            scroll-snap-align: start;
            display: grid;
            place-items: center;
            scroll-snap-stop: always;
        }

        .main-content-space {
            position: relative;
            width: 660px;
            height: 480px;
            top: 24px;
        }

        /* ここまで */

        .s1 {
            position: relative;
            overflow: hidden;
        }

        /* 名前全体を中央に */
        .s1 .top-content-space {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);

            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2.5rem;

            z-index: 10;
            opacity: 0;
        }

        .is-enter .s1 .top-content-space {
            animation: floatIn 2.8s ease-out forwards;
        }

        @keyframes floatIn {
            from {
                opacity: 0;
                transform: translate(-50%, calc(3vh - 50%));
            }

            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .s1 .top-name-text {
            display: flex;
            gap: 2rem;

            writing-mode: vertical-rl;
            text-orientation: upright;
        }

        .s1 .top-last-name,
        .s1 .top-first-name {
            margin: 0;
            font-size: 5rem;
            font-weight: bold;
            letter-spacing: 0.03em;
            line-height: 1;
            white-space: nowrap;
            flex: 0 0 auto;
        }

        .s1 .slideshow {
            position: absolute;
            inset: 0;
        }

        .s1 .slideshow::after {
            content: "";
            position: absolute;
            inset: 0;
            background: rgba(19, 52, 99, 0.5);
            mix-blend-mode: multiply;
            pointer-events: none;
            z-index: 2;
        }

        .s1 .slideshow img {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 1.2s ease;
            z-index: 1;
        }

        .s1 .slideshow img.is-active {
            opacity: 1;
        }

        /* .s2 {} */

        /* .about-background-img {
            position: relative;
            overflow: hidden;
            isolation: isolate;
            
            background-image: url('img/kisosotaro-2-pc.webp');
            background-size: cover;
            background-position: center;
            z-index: 1;
        }

        .about-background-img::after {
            content: "";
            position: absolute;
            inset: 0;
            background: rgba(19, 52, 99, 0.4);
            mix-blend-mode: multiply;
            pointer-events: none;
            z-index: 2;
        } */

        .s2 .main-content-space {
            display: grid;
            grid-template-rows: auto 1fr;
            row-gap: 0px;
            z-index: 5;
        }

        .s2 .about-summary-top {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
        }

        .s2 .about-summary-img {
            width: 320px;
            height: 320px;
            display: block;
        }

        .s2 .name-container {
            width: 280px;
            height: 320px;
            display: grid;
            grid-template-columns: auto auto;
            margin-bottom: 0;
            /* about-summary-imgとname-containerの下辺揃え */
            align-content: end;
        }

        .s2 .last-name-main,
        .s2 .first-name-main {
            margin-top: 0;
            margin-bottom: 0;
        }

        .s2 .last-name-sub,
        .s2 .first-name-sub {
            font-size: 0.9rem;
            letter-spacing: 0.3em;
            line-height: 1;

            margin-top: 0.5rem;
            margin-bottom: 1.5rem;
            margin-left: 0.2rem;
        }

        .s2 .about-main-text {
            height: 100%;
            position: relative;
        }

        .s2 .go-detail-button {
            width: 140px;
            height: 40px;
            margin-top: 0;
            margin-left: auto;

            border-radius: 32px;
            background-color: var(--accent);

            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* .s3 {} */

        .s3 .main-content-space {
            width: 696px;
            display: flex;
            flex-direction: row;
        }

        .s3 .works-summary-menu-space {
            width: auto;
            border-right: 0.5px solid var(--sub);
            flex-shrink: 0;

            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            align-items: center;
        }

        .s3 .works-summary-menu-text {
            font-size: 1.5rem;
            padding-right: 32px;
            /* 相殺することで当たり判定は広げながら、スタイルは崩さない */
            padding-block: 32px;
            margin-block: -32px;

            font-weight: normal;
            line-height: 1;
            cursor: pointer;
            opacity: 0.4;
            transition: opacity 0.2s ease;
        }

        .s3 .works-summary-menu-text.is-active {
            opacity: 1;
        }

        .s3 .works-cards-space {
            padding-left: 48px;
            border-left: 0.5px solid var(--sub);
            display: grid;
            place-items: center;
            grid-template-columns: repeat(2, 1fr);
            column-gap: 1rem;
        }

        /* 表示中のカードが1枚のときだけ1列にする */
        .s3 .works-cards-space.is-single {
            grid-template-columns: 1fr;
        }

        .s3 .works-card {
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .s3 .works-card-img {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            overflow: hidden;
            flex-shrink: 0;
        }

        .s3 .works-card-img::after {
            content: "";
            position: absolute;
            inset: 0;
            background: rgba(19, 52, 99, 0.3);
            mix-blend-mode: multiply;
            pointer-events: none;
            z-index: 1;
        }

        .s3 .works-card-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .s3 .works-card-text {
            font-size: 1rem;
            font-weight: bold;
            margin-top: 0.3rem;
            flex: 1;
        }

        /* .s4 {} */

        .s4 .main-content-space {
            display: flex;
            top: 0;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .contact-block {
            display: inline-flex;
            flex-direction: column;
            align-items: flex-start;
        }

        .s4 .contact-sub-text {
            margin-bottom: 16px;
            font-size: 1rem;
            font-weight: 200;
        }

        .s4 .contact-button {
            width: 100%;
            height: 40px;
            margin-top: 16px;

            display: flex;
            align-items: center;
            gap: 16px;

            border-radius: 32px;
            text-decoration: none;
            color: var(--sub);
        }

        .s4 .contact-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: transparent;
            border: 1px solid var(--sub);

            display: grid;
            place-items: center;

            flex-shrink: 0;
        }

        /* 中のアイコン（マスクで抜く） */
        .s4 .contact-icon::before {
            content: "";
            width: 55%;
            height: 55%;
            background: var(--sub);

            mask-repeat: no-repeat;
            mask-position: center;
            mask-size: contain;
        }

        /* それぞれのSVGを割り当て */
        .s4 .contact-icon.icon-insta::before {
            mask-image: url("img/icon-instagram.svg");
        }

        .s4 .contact-icon.icon-email::before {
            mask-image: url("img/icon-email.svg");
        }

        .s4 .contact-icon.icon-tell::before {
            mask-image: url("img/icon-tell.svg");
        }

        .s4 .contact-link-text {
            display: inline-flex;
            align-items: center;
            font-size: 1rem;
            line-height: 1;
            white-space: nowrap;
            text-decoration: underline;
            text-underline-position: under;
        }

        @media (max-width:696px) {

            /* ----- セクション1 ----- */
            .s1 .top-last-name,
            .s1 .top-first-name {
                font-size: 4rem;
            }

            /* ----- セクション2 ----- */
            .s2 .main-content-space {
                width: 90vw;
                height: auto;
                margin-top: 0;
                row-gap: 8px;
            }

            .s2 .about-summary-top {
                flex-direction: column;
                align-items: center;
                gap: 12px;
            }

            .s2 .about-summary-img {
                width: 240px;
                height: 240px;
                display: block;
                order: 1;
            }

            .s2 .name-container {
                width: 240px;
                height: auto;
                order: 2;
                align-content: start;
                margin: 0 auto;
            }

            .s2 .last-name-main,
            .s2 .first-name-main {
                font-size: 2rem;
            }

            .s2 .last-name-sub,
            .s2 .first-name-sub {
                margin-top: 0.2rem;
                margin-bottom: 0.5rem;
            }

            .s2 .about-main-text {
                font-size: 0.8rem;
                margin-left: 0px;
            }

            .s2 .go-detail-button {
                width: 126px;
                height: 36px;
                font-size: 0.8rem;
            }

            /* ----- セクション3 ----- */
            .s3 .main-content-space {
                width: 95vw;
                height: 70vh;
            }

            .s3 .works-summary-menu-text {
                font-size: 1rem;
                padding-right: 8px;
            }

            .s3 .works-cards-space {
                padding-left: 24px;
                padding-right: 12px;
            }

            /* .s3 .works-card-text {
                font-size: 0.7rem;
            } */

            /* ----- セクション4 ----- */
            .s4 .main-content-space {
                width: 95vw;
            }
        }

        @media (max-width:400px) {
            .s3 .works-cards-space {
                padding-left: 16px;
                column-gap: 0.5rem;
                row-gap: 0.5rem;
            }

            .s3 .works-card-img {
                aspect-ratio: 3 / 3;
            }

            .s3 .works-card-text {
                display: none;
            }
        }
    </style>
</head>

<body>
    <div class="loading-overlay" id="loading">
        <div class="loading-logo svg anim-spin"></div>
    </div>
    <main>
        <header>
            <a class="header-logo-container" href="#top">
                <img class="header-logo svg anim-spin" />
            </a>
            <div class="header-menu-container">
                <a class="header-menu-text" href="#about">About</a>
                <a class="header-menu-text" href="#works">Works</a>
                <a class="header-menu-text" href="#contact">Contact</a>
                <a class="hamburger-menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </a>
                <div class="hamburger-menu-overlay">
                    <div class="hamburger-menu-text-container">
                        <a class="hamburger-menu-text" href="#top">Top</a>
                        <a class="hamburger-menu-text" href="#about">About</a>
                        <a class="hamburger-menu-text" href="#works">Works</a>
                        <a class="hamburger-menu-text" href="#contact">Contact</a>
                    </div>
                </div>
            </div>
        </header>

        <div class="feed" id="feed">
            <section class="section s1" id="top">
                <div class="top-content-space">
                    <div class="top-name-text">
                        <div class="top-last-name">城戸</div>
                        <div class="top-first-name">双汰朗</div>
                    </div>
                </div>
                <div class="slideshow" id="slideshow">
                    <img src="img/home_back-ground01.webp">
                    <img src="img/home_back-ground02.webp">
                    <img src="img/home_back-ground03.webp">
                    <img src="img/home_back-ground04.webp">
                    <img src="img/home_back-ground05.webp">
                    <img src="img/home_back-ground06.webp">
                </div>
            </section>

            <!-- about-background-imgは、背景に写真をおきたい場合に使用 -->
            <section class="section s2 about-background-img" id="about">
                <div class="main-content-space">
                    <div class="about-summary-top">
                        <div class="name-container">
                            <h1 class="last-name-main">城戸</h1>
                            <h1 class="first-name-main">双汰朗</h1>
                            <div class="last-name-sub">kido</div>
                            <div class="first-name-sub">sotaro</div>
                        </div>
                        <img class="about-summary-img" src="img/kidosotaro-2-mobile.webp">
                    </div>
                    <p class="about-main-text">
                        2001年、熊本県生まれ。<br>小学生から高校生まで、バドミントンに熱中。<br>高校卒業後、熊本県立大学に進学。石橋研究室に所属し、ゲームエンジンに触れながら、プログラミングを実践的に学ぶ。<br>大学卒業後、情報科学芸術大学院大学（IAMAS）に進学。現在は休学し、プログラマーとして制作協力を軸に活動している。
                    </p>
                    <a class="go-detail-button transition" href="about.html">もっと知る→</a>
                </div>
            </section>

            <section class="section s3" id="works">
                <div class="main-content-space">
                    <div class="works-summary-menu-space" id="worksMenu">
                        <div class="works-summary-menu-text is-active" data-filter="NEW">NEW</div>
                        <div class="works-summary-menu-text" data-filter="2025">2025</div>
                        <div class="works-summary-menu-text" data-filter="2024">2024</div>
                        <div class="works-summary-menu-text" data-filter="2023">2023</div>
                    </div>

                    <div class="works-cards-space" id="worksCards"></div>
                </div>
            </section>

            <section class="section s4" id="contact">
                <div class="main-content-space">
                    <div class="contact-block">
                        <!-- <p class="contact-sub-text">こちらよりご連絡いただけます。</p> -->
                        <a class="contact-button"
                            href="mailto:skido24@iamas.ac.jp?subject=お問い合わせ&body=ご用件をご記入後、送信をお願いします。">
                            <span class="contact-icon icon-email"></span>
                            <span class="contact-link-text">
                                skido24@iamas.ac.jp
                            </span>
                        </a>
                        <a class="contact-button" href="08027200933">
                            <span class="contact-icon icon-tell"></span>
                            <span class="contact-link-text">
                                080-2720-0933
                            </span>
                        </a>
                        <a class="contact-button" href="https://www.instagram.com/sooochan_0809/" target="_blank"
                            rel="noopener">
                            <span class="contact-icon icon-insta"></span>
                            <span class="contact-link-text">
                                sooochan_0809
                            </span>
                        </a>
                    </div>
                </div>
            </section>
        </div>
    </main>
</body>

<script src="js/loading.js" defer></script>
<script src="js/transition.js" defer></script>
<script src="js/hamburger-menu.js" defer></script>
<!-- import を使うので type="module" で読み込む -->
<script type="module" src="js/works-cards.js" defer></script>

<script>
    const feed = document.getElementById("feed");
    const sections = Array.from(feed.querySelectorAll(".section"));
    const SCROLL_KEY = "feedScrollTop";

    // ブラウザの自動復元は window 向けなので、明示的に切って自前でやる
    if ("scrollRestoration" in history) history.scrollRestoration = "manual";

    /* hash が残り続ける問題の対策 */
    let ignoreClearHashUntil = 0;

    function clearHashSafely() {
        if (!location.hash) return;
        if (Date.now() < ignoreClearHashUntil) return; // hashジャンプ直後は触らない
        history.replaceState(null, "", location.pathname + location.search);
    }

    // #リンクで移動した直後は少しだけ保護（スムーズスクロール中に消さない）
    window.addEventListener("hashchange", () => {
        ignoreClearHashUntil = Date.now();
    });

    // 位置を保存（scroll中は頻繁に呼ばれるので軽くデバウンス）
    let saveTimer = null;
    function saveFeedPosition() {
        clearTimeout(saveTimer);
        saveTimer = setTimeout(() => {
            sessionStorage.setItem(SCROLL_KEY, String(feed.scrollTop));

            // ユーザー操作で移動したら hash を消す（ただし hashジャンプ直後は保護）
            clearHashSafely();
        });
    }
    feed.addEventListener("scroll", saveFeedPosition, { passive: true });

    // 位置を復元（hash優先。hashが無いなら保存値を使う）
    function restoreFeedPosition() {
        // hashがあるならそれを優先
        if (location.hash) {
            const id = location.hash.slice(1);
            const target = document.getElementById(id);
            if (target) {
                const idx = sections.indexOf(target);
                if (idx >= 0) {
                    feed.scrollTop = idx * window.innerHeight;
                    return;
                }
            }
        }

        // 保存値を復元
        const saved = sessionStorage.getItem(SCROLL_KEY);
        if (saved != null) {
            const top = Number(saved);
            if (Number.isFinite(top)) feed.scrollTop = top;
        }
    }

    // 「DOMができた」タイミングで一度復元
    window.addEventListener("DOMContentLoaded", () => {
        restoreFeedPosition();
    });

    // リロード時に確実に保存
    window.addEventListener("beforeunload", () => {
        sessionStorage.setItem(SCROLL_KEY, String(feed.scrollTop));
    });
</script>

<script>
    window.S1_SLIDESHOW = (function () {
        const root = document.getElementById("slideshow");
        if (!root) return { start: () => { }, stop: () => { } };

        const imgs = [...root.querySelectorAll("img")];
        if (!imgs.length) return { start: () => { }, stop: () => { } };

        const INTERVAL = 3000; // 1枚見せる時間（ms）
        let index = 0;

        let intervalTimer = null;
        let firstTimer = null;

        function show(i) {
            imgs.forEach((img, n) => img.classList.toggle("is-active", n === i));
        }

        // ① 1枚目だけ仕込む（フェード無し）
        (function primeFirstFrame() {
            imgs.forEach(img => (img.style.transition = "none"));
            show(0);
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    imgs.forEach(img => (img.style.transition = "")); // CSSのtransitionに戻す
                });
            });
        })();

        function stop() {
            if (intervalTimer) clearInterval(intervalTimer);
            if (firstTimer) clearTimeout(firstTimer);
            intervalTimer = null;
            firstTimer = null;
        }

        // alreadyShownMs: 「ロード中にすでに見えてた時間」をここで差し引く
        function start(alreadyShownMs = 0) {
            stop();

            index = 0; // prime状態と同期
            show(0);

            const remain = Math.max(0, INTERVAL - alreadyShownMs);

            // 最初の1回だけ「残り時間」で進める
            firstTimer = setTimeout(() => {
                index = (index + 1) % imgs.length;
                show(index);

                // 以降は通常INTERVAL
                intervalTimer = setInterval(() => {
                    index = (index + 1) % imgs.length;
                    show(index);
                }, INTERVAL);
            }, remain);
        }

        return { start, stop };
    })();
</script>

<script>
    const headerLogo = document.querySelector(".header-logo");
    const feedRoot = document.querySelector("#feed");
    const sectionElements = Array.from(document.querySelectorAll(".section"));

    // 現在位置（ロゴの向き判定用）
    let currentSectionIndex = 0;

    const observer = new IntersectionObserver(
        (entries) => {
            // 複数 intersect した時、より「表示面積が大きい」ものを採用すると安定する
            const visible = entries
                .filter((e) => e.isIntersecting)
                .sort((a, b) => b.intersectionRatio - a.intersectionRatio)[0];

            if (!visible) return;

            const newIndex = sectionElements.indexOf(visible.target);
            if (newIndex === -1) return;
            if (newIndex === currentSectionIndex) return;

            const direction = newIndex > currentSectionIndex ? "cw" : "ccw";
            currentSectionIndex = newIndex;

            // アニメーションリセット
            headerLogo.classList.remove("spin-cw", "spin-ccw");
            void headerLogo.offsetWidth; // 強制リフロー（連続トリガー対策）
            headerLogo.classList.add(direction === "cw" ? "spin-cw" : "spin-ccw");
        },
        {
            root: feedRoot,
            threshold: [0.01, 0.25, 0.5, 0.75, 0.99],
        }
    );

    sectionElements.forEach((section) => observer.observe(section));

    headerLogo.addEventListener("animationend", () => {
        headerLogo.classList.remove("spin-cw", "spin-ccw");
    });
</script>

</html>